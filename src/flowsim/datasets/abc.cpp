#include "abc.hpp"
//--------------------------------------------------------------------------//
#include "../../globals.hpp"
//--------------------------------------------------------------------------//
#include <cmath>
//--------------------------------------------------------------------------//
namespace dst::flowsim
{
  //--------------------------------------------------------------------------//
  ABC3D::ABC3D()
      : ABC3D({Range(0, 2 * M_PI), Range(0, 2 * M_PI), Range(0, 2 * M_PI)}) {}
  //--------------------------------------------------------------------------//
  ABC3D::ABC3D(const Domain<3> &space_domain_standard)
      : Flow<3>({Range(), Range(), Range()},
                space_domain_standard,
                Range(),
                "ABC3D") {}
  //--------------------------------------------------------------------------//
  MaybeVec<3>
  ABC3D::v(const VecR<3> &pos, real) const
  {
    const real &x = pos[0];
    const real &y = pos[1];
    const real &z = pos[2];

    VecR<3> v;
    v[0] = a * sin(z) + c * cos(y);
    v[1] = b * sin(x) + a * cos(z);
    v[2] = c * sin(y) + b * cos(x);

    return v;
  }
  //--------------------------------------------------------------------------//
}
//--------------------------------------------------------------------------//
